\section{Previous Work}

In our threat model and in the works we compare against~\cite{choorod2022tor, didarknet, deeppacket}, we choose to prioritize making classification using only a single packet from any point in the overall traffic flow. This contrasts systems which require entire flows in order to classify~\cite{perera2017comparison, deeppacket, panchenko2011website, amaral2016machine, cao2014survey}.

\subsection{VPN Traffic Profiling}
Deep Packet~\cite{deeppacket} uses a CNN to perform traffic classification into traffic types and application types as labeled in the VPN/non-VPN UNB ISCX dataset~\cite{vpn-dataset}. Their solution achieves 94\% accuracy classifying traffic by type, and 97\% accuracy in classifying by application. Like our work, they use a single packet in the classification task, and do not rely on flow-based features. We note that their work does not perform as well in Tor traffic classification, leading us to conclude that Deep Packet may not generalize as well as \textsc{Forager}. Cui et al use only header information from the ISCX datasets to classify traffic over flows with 99\% accuracy~\cite{onlyheader}. While a novel solution with enhanced privacy as it considers only header features, it still requires flow-based features of the header and therefore multiple packets. Zou et al use the spatial features of the first packet of a flow extracted and applied to a CNN and analyze the time series features of the next three packets using a long short-term memory network (LSTM)~\cite{zhou2018encrypted}. This method shows high accuracy on the dataset but requires flow-based information.

\subsection{Darknet Detection and Profiling}

Lotfollahi et al also study the ISCX dataset for Tor data and profile again by application and traffic type using a single packet approach~\cite{deeppacket}. Tor traffic profiling has been further explored by Lashkari et al~\cite{didarknet} in their DIDarknet system using a single packet, where they also proved accurate results using the ISCX Tor dataset. Other works have used flow-based features for both detecting Darknet activity (binary Tor/non-Tor classification) and profiling Tor traffic into specific applications or traffic types (e.g. streaming, chat, web browsing). Iliadis et al~\cite{iliadis2021darknet} use an amalgamated version of the ISCX Tor and VPN datasets, re-labeled CICDarknet2020, in order to create a binary classification of Darknet and regular traffic, and a multi-class problem of Tor, non-Tor, VPN, and non-VPN. We perform a similar analysis in our experiments and results of the same data. The work uses all 85 features published in the dataset, including flow-based features, and the full traffic information. Using a set of machine learning algorithms, they are able to achieve up to 98\% accuracy; however, in comparison our system uses only a single packet and a minimal set of features to achieve similar results. Ma et al~\cite{Ma2021dark} also achieved noted success in the community classifying the same dataset using a CNN with Root Mean Square (RMS) propagation. They also require flow-based features of the dataset, and would therefore require multiple packets and flow information in a real system. They also only consider Darknet detection without additional profiling and achieve 95\% accuracy, lower than ours in the same task. Sarkar et al~\cite{sarkar2020detection} introduce a Generative Adversarial Network (GAN) in order to stabilize their deep learning model across the same ISCX Tor dataset, and achieve approximately 98\% accuracy, as well. Using flow-based features, they are able to provide a 95\% accuracy in the profiling task across the eight described traffic classes in the dataset; however, they do not provide the results broken down individually so it is difficult to conclude if the model performs evenly well across classes or not. Choorod et al~\cite{choorod2022tor} use a statistical analysis solely of the extracted features of the encrypted packet payload. They find that certain sizes are common across traffic types, as well as certain regions of the encrypted payload. They use Charcount from the Posit Text Profiling Toolset~\cite{Weir2007ThePT} as a ratio value for input to their decision tree-based algorithm. They achieve highly accurate results we compare against in the Experiments section of this work.

\subsection{Filtering Compressed/Plaintext Traffic}
Plaintext filtering can be done through statistical entropy tests~\cite{wood2017cleartext} and has been used to find private medical or geo-location data~\cite{wood2017cleartext, Shbair2020ASO}, covert malware~\cite{singh2021comparative}, and general unencrypted traffic like file transfers or emails. Modern compression and encryption algorithms present such similar high entropy that distinguishing between them is a difficult problem. The HEDGE~\cite{hedge} system is able to parse encrypted from compressed traffic with between 60-94\% accuracy using the Chi Square and a subset of the NIST SP 800-22 tests dependent upon the size of the packet used. They compare against Hahn et al, who achieved a maximum of 66\% accuracy using machine learning models~\cite{Hahn2018DetectingCC}.

\subsection{Intrusion Detection over HTTPS}

Zain ul Abideen et al~\cite{abideen2019vpn} consider the problem of detecting and profiling VPN traffic on port 443, where their system uses non-encrypted, packet level features to determine several VPN types in the traffic flow. They distinguish between VPN configurations, including Tor. Furthermore, they employ a technique using DNS queries to identify malicious or illegitimate VPN servers. This is an interesting notion which may be challenged by the increased use of encrypted DNS and techniques like DNS-over-HTTPS. Identification of SSH flows in encrypted traffic has been accomplished with success when using flow data~\cite{Hellemons2012SSHCureAF}. Detecting brute-force and dictionary attacks over SSH is also a research problem area from which our work on port 443 is inspired~\cite{Ghitte2019FingerprintingTU}.
