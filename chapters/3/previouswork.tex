\section{Previous Work}

Applications for regular expression signature matching to packet payloads originate in content inspection for malware detection. Early work in automatic signature generation for polymorphic worms such as Autograph \cite{KimHyangAh} provided a foundation for signature-based analysis. This expanded into detecting personally identifiable information as well as policy violations such as copyright infringement, inappropriate or sensitive information on enterprise networks, and censorship~\cite{}. Additionally, Tang et al \cite{TANG2009827} found multiple sequence alignment to be effective in rewarding consecutive substring extractions and tolerating noise in traffic. SigBox~\cite{Shim2017SigBoxAS} introduced the technique of generating substring tokens from packet payloads and applying Apriori data mining to find the most frequent ones. The related CSP Algorithm \cite{Sija} and works by Wang et al \cite{WANG2012992}, Szabo et al \cite{Szabo}, LASER \cite{LASER}, and AutoSig \cite{AutoSig} all include feature extraction and sequence alignment. Wang et al describe their system as a four-stage process; we generalize this concept to all these solutions and our own in order to compare various approaches.

In the first step, data is pre-processed in order to prepare it for use at the next stage. This typically involves extraction of certain fields or N number of bytes from the packet payload. For all these systems, sessionization of packet flows and sometimes defragmentation and reassembly based on TCP/IP header values is required \cite{Shim2017SigBoxAS, WANG2012992, Sija, Szabo, AutoSig, LASER}. Once the data is collected and prepared, the second stage finds common substrings across packet data and/or protocol flows. The systems examined which perform feature extraction use either a subtree approach \cite{WANG2012992}, a longest common substring algorithm \cite{AutoSig, LASER}, motifs \cite{Szabo}, or sequential pattern mining \cite{Shim2017SigBoxAS, Sija}. Third, a method of alignment is used to align data based on commonalities between packets. Wang et al, Szabo et al, Vinoth et al \cite{VinothGeorge2013EfficientRE} and LASER use bioinformatics approaches to perform these alignments. A substring tree can also be used for this purpose \cite{AutoSig}. Some of these alignment strategies are additionally informed by a scoring matrix influenced by the tokens derived in the previous step \cite{WANG2012992, Szabo, LASER}. Once the sequences are aligned in an optimal manner, in the fourth and final stage the systems convert their results into regular expressions.
